<html>

<head>
  <title>My app</title>
</head>

<body>

  <script type="module">
    import { message } from 'my-module';
    import './src/local-module.js';

    console.log(`The message is: ${message}`);

    // class is compiled by legacy build
    class Foo {

    }

    // class is compiled by legacy build
    const bar = 'buz';

    async function* asyncGenerator() {
      await Promise.resolve();
      yield 0;
      await Promise.resolve();
      yield 1;
    }
  </script>

  <script type="module">
    console.log('hello world');
  </script>

  <script type="module" src="./app.js"></script>


  <script>
    // sets up a message channel with es-dev-server to receive events
    // for reloading the browser on file change or logging errors
    (function () {
      if (!('EventSource' in window)) {
        return;
      }

      var eventSource = new EventSource('/__es-dev-server__/message-channel');
      var reloading = false;

      eventSource.addEventListener('file-changed', function (e) {
        reloading = true;
        location.reload();
      });

      eventSource.addEventListener('error-message', function (e) {
        if (reloading) {
          return;
        }
        
        console.error(JSON.parse(e.data));
      });

      eventSource.addEventListener('error', function () {
        if (reloading) {
          return;
        }

        console.log('Disconnected from es-dev-server, no longer reloading on file changes.');
        eventSource.close();
      });
    }());
  </script>
</body>


</html>